name: Validate Secrets

on:
  workflow_dispatch:

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Check required secrets
        run: |
          missing=0
          if [ -z "${{ secrets.KUBECONFIG }}" ]; then echo "Missing secret: KUBECONFIG"; missing=1; else echo "KUBECONFIG OK"; fi
          if [ -z "${{ secrets.GHCR_PAT }}" ]; then echo "Missing secret: GHCR_PAT"; missing=1; else echo "GHCR_PAT OK"; fi
          # Optional deployment secrets
          if [ -z "${{ secrets.VERCEL_TOKEN }}" ]; then echo "Warning: VERCEL_TOKEN not set (optional)"; else echo "Vercel token OK"; fi
          if [ -z "${{ secrets.PARTNERSTACK_API_KEY }}" ]; then echo "Warning: PARTNERSTACK_API_KEY not set (optional)"; else echo "PartnerStack key OK"; fi

          if [ "$missing" -eq 1 ]; then echo "Required secrets are missing."; exit 1; fi
          echo "All required secrets are present."